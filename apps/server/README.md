# åç«¯æœåŠ¡ (apps/server)

åŸºäº Next.js çš„ API æœåŠ¡

## ğŸ“ ç›®å½•ç»“æ„

```
src/
â”œâ”€â”€ app/                       # Next.js App Router
â”‚   â”œâ”€â”€ api/                  # API è·¯ç”±
â”‚   â”‚   â”œâ”€â”€ auth/            # è®¤è¯ç›¸å…³
â”‚   â”‚   â”‚   â”œâ”€â”€ login/       # POST /api/auth/login
â”‚   â”‚   â”‚   â”œâ”€â”€ register/    # POST /api/auth/register
â”‚   â”‚   â”‚   â””â”€â”€ phone-login/ # POST /api/auth/phone-login
â”‚   â”‚   â”‚
â”‚   â”‚   â”œâ”€â”€ games/           # æ¸¸æˆç›¸å…³
â”‚   â”‚   â”œâ”€â”€ orders/          # è®¢å•ç›¸å…³
â”‚   â”‚   â””â”€â”€ user/            # ç”¨æˆ·ç›¸å…³
â”‚   â”‚
â”‚   â”œâ”€â”€ layout.tsx           # æ ¹å¸ƒå±€
â”‚   â””â”€â”€ page.tsx             # é¦–é¡µ
â”‚
â”œâ”€â”€ lib/                       # æ ¸å¿ƒåº“
â”‚   â”œâ”€â”€ auth.ts              # è®¤è¯å·¥å…·ï¼ˆJWTã€å¯†ç åŠ å¯†ï¼‰
â”‚   â”œâ”€â”€ response.ts          # å“åº”æ ¼å¼åŒ–
â”‚   â””â”€â”€ validators.ts        # å‚æ•°æ ¡éªŒ
â”‚
â”œâ”€â”€ services/                  # ä¸šåŠ¡æœåŠ¡å±‚
â”‚   â”œâ”€â”€ auth.service.ts      # è®¤è¯æœåŠ¡
â”‚   â”œâ”€â”€ wechat.service.ts    # å¾®ä¿¡æœåŠ¡
â”‚   â””â”€â”€ index.ts             # å¯¼å‡º
â”‚
â”œâ”€â”€ middlewares/               # ä¸­é—´ä»¶
â”‚
â”œâ”€â”€ types/                     # ç±»å‹å®šä¹‰
â”‚
â””â”€â”€ utils/                     # å·¥å…·å‡½æ•°
```

## ğŸ”— API æ¥å£

### è®¤è¯æ¨¡å— `/api/auth`

| æ¥å£ | æ–¹æ³• | è¯´æ˜ |
|-----|------|-----|
| `/api/auth/login` | POST | è´¦å·å¯†ç ç™»å½• |
| `/api/auth/register` | POST | ç”¨æˆ·æ³¨å†Œ |
| `/api/auth/phone-login` | POST | æ‰‹æœºå·ä¸€é”®ç™»å½• |

### æ¸¸æˆæ¨¡å— `/api/games`

| æ¥å£ | æ–¹æ³• | è¯´æ˜ |
|-----|------|-----|
| `/api/games` | GET | è·å–æ¸¸æˆåˆ—è¡¨ |
| `/api/games/[id]` | GET | è·å–æ¸¸æˆè¯¦æƒ… |

### è®¢å•æ¨¡å— `/api/orders`

| æ¥å£ | æ–¹æ³• | è¯´æ˜ |
|-----|------|-----|
| `/api/orders` | GET | è·å–è®¢å•åˆ—è¡¨ |
| `/api/orders` | POST | åˆ›å»ºè®¢å• |
| `/api/orders/[id]` | GET | è·å–è®¢å•è¯¦æƒ… |

## ğŸ”§ å¼€å‘å‘½ä»¤

```bash
# å¼€å‘æ¨¡å¼
pnpm dev:server

# ç¼–è¯‘æ„å»º
pnpm build:server
```

## ğŸ“ å¼€å‘è§„èŒƒ

### API è·¯ç”±
- ä½¿ç”¨ Next.js App Router
- æ¯ä¸ªæ¥å£ç‹¬ç«‹ç›®å½•ï¼ŒåŒ…å« `route.ts`
- è·¯ç”±æ–‡ä»¶åªå¤„ç†è¯·æ±‚/å“åº”ï¼Œä¸šåŠ¡é€»è¾‘æ”¾æœåŠ¡å±‚

### æœåŠ¡å±‚
- æœåŠ¡æ–‡ä»¶å‘½åï¼š`xxx.service.ts`
- è´Ÿè´£ä¸šåŠ¡é€»è¾‘å¤„ç†
- è¿”å›ç»Ÿä¸€æ ¼å¼çš„ç»“æœ

### å“åº”æ ¼å¼
```typescript
{
  code: 0,        // 0 æˆåŠŸï¼Œé 0 å¤±è´¥
  message: '',    // æç¤ºä¿¡æ¯
  data: {}        // æ•°æ®
}
```

